<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="style.css">
        <title>244048 - Arkadiusz Zasina</title>
    </head>
    <script>
        function generateBox() {
            console.log("generate");
            let container = document.getElementById("boxContainer");
            let box = document.createElement("div");
            box.setAttribute("class", "box");
            let width = Math.floor(document.body.clientWidth / 10) + "px";
            let height = Math.floor(document.body.clientHeight / 8) + "px";
            box.style.width = width;
            box.style.height = height;
            box.style.backgroundColor = "#" + Math.floor(Math.random() *255 * 255 * 255).toString(16);
            console.log(box);
            container.innerHTML = "";
            container.appendChild(box);
        }

        function allowDrop(ev) {
            ev.preventDefault();
        }

        function dragStart(ev) {
            let index = findTargetIndex(ev);
            ev.dataTransfer.setData("text", index);
        }

        function drop(ev) {
            ev.preventDefault();
            let indexToInsert = parseInt(ev.dataTransfer.getData("text"));
            let indexToInsertAfter = findTargetIndex(ev);
            let child = ev.target.parentNode.children[indexToInsert];
            let childBefore = ev.target.parentNode.children[indexToInsertAfter];
            ev.target.parentNode.removeChild(child);
            ev.target.parentNode.insertBefore(child, childBefore.nextSibling);
        }

        // function findTargetIndex(ev) {
        //     let children = Array.prototype.slice.call( ev.target.parentNode.children );
        //     return children.findIndex(x => x.attributes['num'].value == ev.target.attributes['num'].value);
        // }

        function initializeTable(ev) {
            let table = document.getElementById("maingrid");
            for (let i = 0; i < 8; i++) {
                let row = document.createElement("tr")
                table.appendChild(row);
                for (let j = 0; j < 8; j++) {
                    let cell = document.createElement("td");
                    row.appendChild(cell);
                }
            }
        }
    </script>
    <body onLoad="initializeTable(event)">
        <div class="app">
            <div class="platform">
                <table id="maingrid"></table>
            </div>
            <div class="builder">
                <button onclick="generateBox()">Generuj klocek</button>
                <div id="boxContainer"></div>
            </div>
        </div>
    </body>
</html>